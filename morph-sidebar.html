<link rel="import" href="/bower_components/polymer/lib/utils/render-status.html">
<link rel="import" href="/bower_components/polymer/lib/mixins/gesture-event-listeners.html"> <!-- import needed to use Polymer Gestures Mixin -->
<link rel="import" href="/bower_components/morph-element/morph-element.html">
<link rel="import" href="/bower_components/app-layout/app-drawer/app-drawer.html">


<dom-module id="morph-sidebar">
  <template>
    <style>
      :host {
        --sidebar-width: 260px;
        --sidebar-background-color: #e7e7e7;

        background: var(--sidebar-background-color);
        box-sizing: border-box;
        display: block;
        height: 100%;
        overflow: auto;
        position: absolute;
        top: 0;
        transform: translate3d(0,0,0);
        width: var(--sidebar-width);
        z-index: 1000;
        -webkit-overflow-scrolling: touch;
      }

      :host([platform="ios"]) {
        transition-duration: 400ms;
      }

      :host([platform="android"]) {
        transition: 300ms;
      }

      :host([platform="android"][open]) {
        box-shadow: 0 0 20px rgba(0,0,0,.5);
      }

      :host(.not-animated) {
        transition: 0ms;
      }

      :host([side="left"]) {
        left: 0;
      }

      :host([side="right"]) {
        right: 0;
      }

      :host([side="left"]:not([open])) {
        transform: translate3d(-100%, 0, 0);
      }

      :host([side="right"]:not([open])) {
        transform: translate3d(100%, 0, 0);
      }
    </style>

    <div id="container">
      <!-- app-drawer template goes here -->
    </div>


  </template>

  <script>
    (function() {
      let memoizedTemplate;
      /**
       * `morph-sidebar`
       * Sidebar that morphs for current mobile OS
       *
       * @customElement
       * @polymer
       * @demo morph-sidebar/demo/index.html
       */
      class MorphSidebar extends Polymer.GestureEventListeners(customElements.get('app-drawer')) {
        static get is() { return 'morph-sidebar'; }

        static get properties() {
          return {
            side: {
              type: String,
              value: "left",
              reflectToAttribute: true
            },
            open: {
              type: Boolean,
              value: false,
              notify: true,
              reflectToAttribute: true
            },
            position: {
              type: String,
              readOnly: true,
              reflectToAttribute: true
            }
          };
        }

        static get template() {
          if (!memoizedTemplate) {
            // Retrieve this element's dom-module template
            memoizedTemplate = Polymer.DomModule.import(this.is, 'template');

            let MySuperClass = customElements.get('app-drawer');
            // Clone the contents of the superclass template
            let superTemplateContents = document.importNode(MySuperClass.template.content, true);

            // Insert the superclass contents
            let footer = memoizedTemplate.content.querySelector('#container');
            // memoizedTemplate.content.insertBefore(superTemplateContents, footer);
            footer.appendChild(superTemplateContents);
            
          }
          return memoizedTemplate;
        }

        /**
         * Set open property to true use to open the sidebar
         */
        setOpen() {
          this.set('open', true);
        }

        /**
         * Set open property to false use to close the sidebar
         */
        setClosed() {
          this.set('open', false);
        }

        /**
         * Toggle open property open to close and close to open
         */
        toggle() {
          this.open = !this.open;
        }


      }

      window.customElements.define(MorphSidebar.is, MorphSidebar);

    })();

  </script>
</dom-module>
